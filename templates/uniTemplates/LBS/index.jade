doctype html
html(lang='en',ng-app = "resumeEditApp")
    head
        title LBS Template  
        meta(charset='utf-8', name='name', content='content')
        link(rel='stylesheet', href='./static/templateSpecific/LBS/LBS.css')
        link(rel='stylesheet', href='./static/popper.css')
    body(ng-controller = "mainCtrl")
        section.personalInformation
            .personalInformation.name(contenteditable ng-model = "resumeData.personalInformation.name") {{resumeData.personalInformation.name}}
            .personalInformation.email(contenteditable ng-model = "resumeData.personalInformation.email") {{resumeData.personalInformation.email}}
            .personalInformation.phone(contenteditable ng-model = "resumeData.personalInformation.phone") {{resumeData.personalInformation.phone}}
        section.education
            h1 Education
            .educationPoint(ng-repeat = "educationPoint in resumeData.education")
                .separated
                    .educationPoint.date {{educationPoint.startyear}} - {{educationPoint.endyear}}
                    .rightCol
                        .educationPoint.schoolname(contenteditable ng-model = "educationPoint.schoolname" ) {{educationPoint.schoolname}}
                        .educationPoint.degree(contenteditable ng-model = "educationPoint.degree") {{educationPoint.degree}}
                        ul
                            li.education.Bullet(ng-repeat = "bullet in educationPoint.bullets" contenteditable ng-model = "bullet.text") {{bullet.text}}
        section.experience
            h1  Experience
            .experiencePoint(ng-repeat = "experiencePoint in resumeData.experience")
                .separated
                    .experiencePoint.date {{experiencePoint.data_raw}}            
                    .rightCol
                        .experiencePoint.company(contenteditable ng-model ="experiencePoint.companyname") {{experiencePoint.companyname}}
                        .experiencePoint.location(contenteditable ng-model ="experiencePoint.location") {{experiencePoint.location}}
                        //- .experiencePoint.companydescription Central Bank of Saudi Arabia.
                        .experiencePoint.companydescription(contenteditable ng-model ="experiencePoint.industry") {{experiencePoint.industry}}
                        .experiencePoint.designation(contenteditable ng-model ="experiencePoint.position") {{experiencePoint.position}}
                        ul.experiencePoint.bullets
                            li.experiencePoint.bullet(contenteditable ng-model = "bullet.text" ng-repeat = "bullet in experiencePoint.bullets") {{bullet.text}}
        section.additionalInformation
            h1 Additional Information        
            ul.additionalInformation.bullets
                li.additionalInformation.bullet(contenteditable ng-model = "bullet.text" ng-repeat = "bullet in resumeData.additional_data.bullets") {{bullet.text}} 
        section.languages
            h1 Languages
            .languages.text() Fluent English, Native Arabic
        section.nationality
            h1 Nationality
            .nationality.text() Saudi Arabia
        script(src = "./static/bower_components/angular/angular.min.js")
        script(src = "./static/bower_components/jquery/dist/jquery.min.js")
        script(src = "./node_modules/popper.js/build/popper.min.js")
        script.
            var resumeDataOld = !{JSON.stringify(resume)}
            for (var educationPoint of resumeDataOld.education)
            {
                educationPoint.bullets = educationPoint.bullets.map(function(bullet){
                    return {"text":bullet}
                })
            }
            for (var experiencePoint of resumeDataOld.experience)
            {
                experiencePoint.bullets = experiencePoint.bullets.map(function(bullet){
                    return {"text":bullet}
                })
            }
            console.log(resumeDataOld);
            var app = angular.module("resumeEditApp", []).controller('mainCtrl',function ($scope)
                {
                    $scope.resumeData = resumeDataOld
                    $scope.teritoh = function()
                    {
                        
                    }
                })
                app.directive("contenteditable", function() {
                return {
                    restrict: "A",
                    require: "ngModel",
                    link: function(scope, element, attrs, ngModel) {

                      function read() {
                        ngModel.$setViewValue(element.html());
                      }

                      ngModel.$render = function() {
                        element.html(ngModel.$viewValue || "");
                      };

                      element.bind("blur keyup change", function() {
                        scope.$apply(read);
                      });
                    }
                    };
                });
        script(src = "./node_modules/popper.js/build/popper.min.js")
        script(src = "./static/templateSpecific/core.js")
        
